{"ast":null,"code":"import _objectSpread from \"C:/Inventory-Clinic-MCC/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _regeneratorRuntime from \"C:/Inventory-Clinic-MCC/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Inventory-Clinic-MCC/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.object.define-property.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.parse-float.js\";\nimport \"core-js/modules/es.parse-int.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.find.js\";\nimport { ref, computed, onMounted, watch } from 'vue';\nimport { MinusIcon, PlusIcon, UploadIcon, EditIcon, SearchIcon, ChevronLeftIcon, ChevronRightIcon } from 'lucide-vue-next';\nimport axios from 'axios';\nimport debounce from 'lodash/debounce';\nvar API_URL = 'http://localhost:5000/api/inventory'; // Replace with your actual API URL\n\nvar itemsPerPage = 10;\nexport default {\n  __name: 'Inventory',\n  setup: function setup(__props, _ref) {\n    var __expose = _ref.expose;\n    __expose();\n    var items = ref([]);\n    var categories = ref([]);\n    var tableHeaders = ['Name', 'Description', 'Category', 'Quantity in Stock', 'Min Stock Level', 'Unit Price', 'Reorder Level'];\n    var searchQuery = ref('');\n    var selectedCategory = ref('');\n    var showAddModal = ref(false);\n    var showNewCategoryModal = ref(false);\n    var newCategory = ref({\n      name: '',\n      description: ''\n    });\n    var currentItem = ref({\n      name: '',\n      description: '',\n      category_id: null,\n      quantity_in_stock: 0,\n      min_stock_level: 0,\n      unit_price: 0,\n      reorder_level: 0\n    });\n    var editingItem = ref(null);\n\n    // Pagination\n    var currentPage = ref(1);\n    var totalItems = ref(0); // Ensure this is initialized to 0\n    var totalPages = computed(function () {\n      return Math.ceil(totalItems.value / itemsPerPage);\n    });\n    var paginationStart = computed(function () {\n      return Math.max((currentPage.value - 1) * itemsPerPage + 1, 0);\n    });\n    var paginationEnd = computed(function () {\n      return Math.min(currentPage.value * itemsPerPage, totalItems.value);\n    });\n    var displayedPages = computed(function () {\n      var range = 2;\n      var start = Math.max(1, currentPage.value - range);\n      var end = Math.min(totalPages.value, currentPage.value + range);\n      if (end - start + 1 < range * 2 + 1) {\n        if (start === 1) {\n          end = Math.min(start + range * 2, totalPages.value);\n        } else {\n          start = Math.max(end - range * 2, 1);\n        }\n      }\n      return Array.from({\n        length: end - start + 1\n      }, function (_, i) {\n        return start + i;\n      });\n    });\n\n    // Watch for category selection\n    watch(function () {\n      return currentItem.value.category_id;\n    }, function (newValue) {\n      if (newValue === 'new') {\n        showNewCategoryModal.value = true;\n        currentItem.value.category_id = ''; // Reset selection\n      }\n    });\n\n    // Add new method to handle category changes\n    var handleCategoryChange = function handleCategoryChange(event) {\n      var value = event.target.value;\n      if (value === 'new') {\n        showNewCategoryModal.value = true;\n        // Store the previous selection\n        selectedCategory.value = '';\n      } else {\n        fetchItems();\n      }\n    };\n\n    // Add new methods for category management\n    var closeNewCategoryModal = function closeNewCategoryModal() {\n      showNewCategoryModal.value = false;\n      newCategory.value = {\n        name: '',\n        description: ''\n      };\n    };\n    // Update submitNewCategory to handle both contexts\n    var submitNewCategory = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var response, newCat;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return axios.post(\"\".concat(API_URL, \"/categories\"), newCategory.value);\n            case 3:\n              response = _context.sent;\n              if (response.data.success) {\n                newCat = response.data.data; // Add the new category to the categories list\n                categories.value.push(newCat);\n\n                // If adding from the item modal, select the new category\n                if (showAddModal.value) {\n                  currentItem.value.category_id = newCat.id;\n                }\n\n                // Close the modal and reset form\n                closeNewCategoryModal();\n                // Fetch items to refresh the list\n                fetchItems();\n              }\n              _context.next = 10;\n              break;\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](0);\n              console.error('Error creating category:', _context.t0);\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[0, 7]]);\n      }));\n      return function submitNewCategory() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    onMounted(function () {\n      fetchCategories();\n      fetchItems();\n    });\n    var fetchCategories = /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return axios.get(\"\".concat(API_URL, \"/categories\"));\n            case 3:\n              response = _context2.sent;\n              categories.value = response.data.data;\n              _context2.next = 10;\n              break;\n            case 7:\n              _context2.prev = 7;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.error('Error fetching categories:', _context2.t0);\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[0, 7]]);\n      }));\n      return function fetchCategories() {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n    var debouncedFetchItems = debounce(function () {\n      fetchItems();\n    }, 300);\n    watch(searchQuery, function () {\n      debouncedFetchItems();\n    });\n    watch(selectedCategory, function () {\n      fetchItems();\n    });\n    var fetchItems = /*#__PURE__*/function () {\n      var _ref4 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              _context3.next = 3;\n              return axios.get(\"\".concat(API_URL, \"/items\"), {\n                params: {\n                  page: currentPage.value,\n                  limit: itemsPerPage,\n                  search: searchQuery.value,\n                  category: selectedCategory.value\n                }\n              });\n            case 3:\n              response = _context3.sent;\n              if (response.data.success) {\n                items.value = response.data.data || []; // Default to empty array if no data\n                totalItems.value = response.data.total_count || 0; // Default to 0 if no total count\n                console.log(\"Reorder Level:\", items.value.reorder_level);\n                if (currentPage.value > totalPages.value) {\n                  currentPage.value = 1;\n                }\n              } else {\n                console.error('Failed to fetch items:', response.data.message);\n              }\n              _context3.next = 10;\n              break;\n            case 7:\n              _context3.prev = 7;\n              _context3.t0 = _context3[\"catch\"](0);\n              console.error('Error fetching items:', _context3.t0);\n            case 10:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, null, [[0, 7]]);\n      }));\n      return function fetchItems() {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n    var prevPage = function prevPage() {\n      if (currentPage.value > 1) {\n        currentPage.value--;\n        fetchItems();\n      }\n    };\n    var nextPage = function nextPage() {\n      if (currentPage.value < totalPages.value) {\n        currentPage.value++;\n        fetchItems();\n      }\n    };\n    var goToPage = function goToPage(page) {\n      currentPage.value = page;\n      fetchItems();\n    };\n    var editItem = function editItem(item) {\n      editingItem.value = item;\n      currentItem.value = _objectSpread({}, item);\n      showAddModal.value = true;\n    };\n    var closeModal = function closeModal() {\n      showAddModal.value = false;\n      editingItem.value = null;\n      currentItem.value = {\n        name: '',\n        description: '',\n        category_id: null,\n        quantity_in_stock: 0,\n        min_stock_level: 0,\n        unit_price: 0,\n        reorder_level: 0\n      };\n    };\n    var submitItem = /*#__PURE__*/function () {\n      var _ref5 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        var itemData;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.prev = 0;\n              itemData = {\n                name: currentItem.value.name,\n                description: currentItem.value.description,\n                category_id: parseInt(currentItem.value.category_id),\n                quantity_in_stock: parseInt(currentItem.value.quantity_in_stock),\n                min_stock_level: parseInt(currentItem.value.min_stock_level),\n                unit_price: parseFloat(currentItem.value.unit_price),\n                reorder_level: parseInt(currentItem.value.reorder_level)\n              };\n              if (!editingItem.value) {\n                _context4.next = 7;\n                break;\n              }\n              _context4.next = 5;\n              return axios.put(\"\".concat(API_URL, \"/items/\").concat(editingItem.value.id), itemData);\n            case 5:\n              _context4.next = 9;\n              break;\n            case 7:\n              _context4.next = 9;\n              return axios.post(\"\".concat(API_URL, \"/items\"), itemData);\n            case 9:\n              closeModal();\n              fetchItems();\n              _context4.next = 16;\n              break;\n            case 13:\n              _context4.prev = 13;\n              _context4.t0 = _context4[\"catch\"](0);\n              console.error('Error submitting item:', _context4.t0);\n            case 16:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, null, [[0, 13]]);\n      }));\n      return function submitItem() {\n        return _ref5.apply(this, arguments);\n      };\n    }();\n    var uploadExcel = /*#__PURE__*/function () {\n      var _ref6 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(event) {\n        var file, formData;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              file = event.target.files[0];\n              if (file) {\n                _context5.next = 3;\n                break;\n              }\n              return _context5.abrupt(\"return\");\n            case 3:\n              formData = new FormData();\n              formData.append('file', file);\n              _context5.prev = 5;\n              _context5.next = 8;\n              return axios.post(\"\".concat(API_URL, \"/upload-excel\"), formData, {\n                headers: {\n                  'Content-Type': 'multipart/form-data'\n                }\n              });\n            case 8:\n              fetchItems();\n              _context5.next = 14;\n              break;\n            case 11:\n              _context5.prev = 11;\n              _context5.t0 = _context5[\"catch\"](5);\n              console.error('Error uploading Excel file:', _context5.t0);\n            case 14:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, null, [[5, 11]]);\n      }));\n      return function uploadExcel(_x) {\n        return _ref6.apply(this, arguments);\n      };\n    }();\n    var getCategoryName = function getCategoryName(categoryId) {\n      var category = categories.value.find(function (cat) {\n        return cat.id === categoryId;\n      });\n      return category ? category.name : 'Unknown';\n    };\n    var filteredItems = computed(function () {\n      var filtered = items.value;\n      if (searchQuery.value) {\n        var query = searchQuery.value.toLowerCase();\n        filtered = filtered.filter(function (item) {\n          return item.name.toLowerCase().includes(query) || item.description.toLowerCase().includes(query);\n        });\n      }\n      if (selectedCategory.value) {\n        filtered = filtered.filter(function (item) {\n          return item.category_id === parseInt(selectedCategory.value);\n        });\n      }\n      return filtered;\n    });\n    var showReduceStockModal = ref(false);\n    var reduceQuantity = ref(0);\n    var openReduceStockModal = function openReduceStockModal(item) {\n      currentItem.value = _objectSpread({}, item);\n      reduceQuantity.value = 0;\n      showReduceStockModal.value = true;\n    };\n    var closeReduceStockModal = function closeReduceStockModal() {\n      showReduceStockModal.value = false;\n      currentItem.value = {\n        name: '',\n        description: '',\n        category_id: null,\n        quantity_in_stock: 0,\n        min_stock_level: 0,\n        unit_price: 0,\n        reorder_level: 0\n      };\n    };\n    var reduceStock = /*#__PURE__*/function () {\n      var _ref7 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n              _context6.prev = 0;\n              _context6.next = 3;\n              return axios.post(\"\".concat(API_URL, \"/items/\").concat(currentItem.value.id, \"/reduce-stock\"), {\n                quantity: parseInt(reduceQuantity.value)\n              });\n            case 3:\n              response = _context6.sent;\n              if (response.data.success) {\n                alert('Stock reduced successfully!');\n                closeReduceStockModal();\n                fetchItems();\n              } else {\n                alert('Failed to reduce stock. Please try again.');\n              }\n              _context6.next = 11;\n              break;\n            case 7:\n              _context6.prev = 7;\n              _context6.t0 = _context6[\"catch\"](0);\n              console.error('Error reducing stock:', _context6.t0);\n              alert('An error occurred while reducing stock.');\n            case 11:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee6, null, [[0, 7]]);\n      }));\n      return function reduceStock() {\n        return _ref7.apply(this, arguments);\n      };\n    }();\n    var __returned__ = {\n      API_URL: API_URL,\n      items: items,\n      categories: categories,\n      tableHeaders: tableHeaders,\n      searchQuery: searchQuery,\n      selectedCategory: selectedCategory,\n      showAddModal: showAddModal,\n      showNewCategoryModal: showNewCategoryModal,\n      newCategory: newCategory,\n      currentItem: currentItem,\n      editingItem: editingItem,\n      itemsPerPage: itemsPerPage,\n      currentPage: currentPage,\n      totalItems: totalItems,\n      totalPages: totalPages,\n      paginationStart: paginationStart,\n      paginationEnd: paginationEnd,\n      displayedPages: displayedPages,\n      handleCategoryChange: handleCategoryChange,\n      closeNewCategoryModal: closeNewCategoryModal,\n      submitNewCategory: submitNewCategory,\n      fetchCategories: fetchCategories,\n      debouncedFetchItems: debouncedFetchItems,\n      fetchItems: fetchItems,\n      prevPage: prevPage,\n      nextPage: nextPage,\n      goToPage: goToPage,\n      editItem: editItem,\n      closeModal: closeModal,\n      submitItem: submitItem,\n      uploadExcel: uploadExcel,\n      getCategoryName: getCategoryName,\n      filteredItems: filteredItems,\n      showReduceStockModal: showReduceStockModal,\n      reduceQuantity: reduceQuantity,\n      openReduceStockModal: openReduceStockModal,\n      closeReduceStockModal: closeReduceStockModal,\n      reduceStock: reduceStock,\n      ref: ref,\n      computed: computed,\n      onMounted: onMounted,\n      watch: watch,\n      get MinusIcon() {\n        return MinusIcon;\n      },\n      get PlusIcon() {\n        return PlusIcon;\n      },\n      get UploadIcon() {\n        return UploadIcon;\n      },\n      get EditIcon() {\n        return EditIcon;\n      },\n      get SearchIcon() {\n        return SearchIcon;\n      },\n      get ChevronLeftIcon() {\n        return ChevronLeftIcon;\n      },\n      get ChevronRightIcon() {\n        return ChevronRightIcon;\n      },\n      get axios() {\n        return axios;\n      },\n      get debounce() {\n        return debounce;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","watch","MinusIcon","PlusIcon","UploadIcon","EditIcon","SearchIcon","ChevronLeftIcon","ChevronRightIcon","axios","debounce","API_URL","itemsPerPage","items","categories","tableHeaders","searchQuery","selectedCategory","showAddModal","showNewCategoryModal","newCategory","name","description","currentItem","category_id","quantity_in_stock","min_stock_level","unit_price","reorder_level","editingItem","currentPage","totalItems","totalPages","Math","ceil","value","paginationStart","max","paginationEnd","min","displayedPages","range","start","end","Array","from","length","_","i","newValue","handleCategoryChange","event","target","fetchItems","closeNewCategoryModal","submitNewCategory","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","newCat","wrap","_callee$","_context","prev","next","post","concat","sent","data","success","push","id","t0","console","error","stop","apply","arguments","fetchCategories","_ref3","_callee2","_callee2$","_context2","get","debouncedFetchItems","_ref4","_callee3","_callee3$","_context3","params","page","limit","search","category","total_count","log","message","prevPage","nextPage","goToPage","editItem","item","_objectSpread","closeModal","submitItem","_ref5","_callee4","itemData","_callee4$","_context4","parseInt","parseFloat","put","uploadExcel","_ref6","_callee5","file","formData","_callee5$","_context5","files","abrupt","FormData","append","headers","_x","getCategoryName","categoryId","find","cat","filteredItems","filtered","query","toLowerCase","filter","includes","showReduceStockModal","reduceQuantity","openReduceStockModal","closeReduceStockModal","reduceStock","_ref7","_callee6","_callee6$","_context6","quantity","alert"],"sources":["C:/Inventory-Clinic-MCC/frontend/src/views/Inventory.vue"],"sourcesContent":["  <template>\r\n    <div class=\"min-h-screen bg-gray-100\">\r\n      <div class=\"container mx-auto px-4 py-8\">\r\n        <h1 class=\"text-3xl font-bold text-gray-800 mb-2\">Inventory Management</h1>\r\n        <p class=\"text-gray-600 mb-8\">Manage your inventory items, track stock levels, and maintain product information.</p>\r\n        \r\n        <div class=\"bg-white rounded-lg shadow-md p-6 mb-8\">\r\n          <div class=\"flex flex-col md:flex-row justify-between items-center mb-6\">\r\n            <div class=\"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4 mb-4 md:mb-0\">\r\n              <button @click=\"showAddModal = true\" class=\"btn-primary\">\r\n                <PlusIcon class=\"w-5 h-5 mr-2\" />\r\n                Add Item\r\n              </button>\r\n              <label class=\"btn-secondary\">\r\n                <UploadIcon class=\"w-5 h-5 mr-2\" />\r\n                Upload Excel\r\n                <input type=\"file\" class=\"hidden\" @change=\"uploadExcel\" accept=\".xlsx, .xls\" />\r\n              </label>\r\n            </div>\r\n            <div class=\"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4 w-full md:w-auto\">\r\n              <div class=\"relative\">\r\n                <input \r\n                  v-model=\"searchQuery\" \r\n                  type=\"text\" \r\n                  placeholder=\"Search items...\" \r\n                  class=\"pl-10 pr-4 py-2 w-full sm:w-64 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                  \r\n                />\r\n                <SearchIcon class=\"absolute left-3 top-2.5 text-gray-400 w-5 h-5\" />\r\n              </div>\r\n              <select \r\n                v-model=\"selectedCategory\" \r\n                class=\"w-full sm:w-auto border rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                @change=\"handleCategoryChange\"\r\n              >\r\n                <option value=\"\">All Categories</option>\r\n                <option v-for=\"category in categories\" :key=\"category.id\" :value=\"category.id\">\r\n                  {{ category.name }}\r\n                </option>\r\n                <option value=\"new\">+ Add New Category</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- New Category Modal -->\r\n          <Teleport to=\"body\">\r\n            <div v-if=\"showNewCategoryModal\" class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4\" style=\"z-index: 100;\">\r\n              <div class=\"bg-white rounded-lg shadow-xl w-full max-w-md p-6\">\r\n                <h3 class=\"text-xl font-bold mb-4\">Add New Category</h3>\r\n                <form @submit.prevent=\"submitNewCategory\">\r\n                  <div class=\"space-y-4\">\r\n                    <div>\r\n                      <label for=\"categoryName\" class=\"block text-sm font-medium text-gray-700\">Category Name</label>\r\n                      <input \r\n                        type=\"text\" \r\n                        id=\"categoryName\" \r\n                        v-model=\"newCategory.name\" \r\n                        required \r\n                        class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50\"\r\n                      />\r\n                    </div>\r\n                    <div>\r\n                      <label for=\"categoryDescription\" class=\"block text-sm font-medium text-gray-700\">Description</label>\r\n                      <textarea \r\n                        id=\"categoryDescription\" \r\n                        v-model=\"newCategory.description\" \r\n                        rows=\"3\" \r\n                        class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50\"\r\n                      ></textarea>\r\n                    </div>\r\n                    <div class=\"flex justify-end space-x-3\">\r\n                      <button type=\"button\" @click=\"closeNewCategoryModal\" class=\"btn-secondary\">\r\n                        Cancel\r\n                      </button>\r\n                      <button type=\"submit\" class=\"btn-primary\">\r\n                        Add Category\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </form>\r\n              </div>\r\n            </div>\r\n          </Teleport>\r\n\r\n        </div>\r\n\r\n        <div class=\"bg-white rounded-lg shadow-md overflow-hidden\">\r\n          <div class=\"overflow-x-auto\">\r\n            <table class=\"min-w-full divide-y divide-gray-200\">\r\n              <thead class=\"bg-gray-50\">\r\n                <tr>\r\n                  <th v-for=\"header in tableHeaders\" :key=\"header\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    {{ header }}\r\n                  </th>\r\n                  <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Actions\r\n                  </th>\r\n                </tr>\r\n              </thead>\r\n              <tbody class=\"bg-white divide-y divide-gray-200\">\r\n                <tr v-for=\"item in filteredItems\" :key=\"item.id\" class=\"hover:bg-gray-50\">\r\n                  <td class=\"px-6 py-4 whitespace-nowrap\">{{ item.name }}</td>\r\n                  <td class=\"px-6 py-4 whitespace-nowrap\">{{ item.description }}</td>\r\n                  <td class=\"px-6 py-4 whitespace-nowrap\">{{ getCategoryName(item.category_id) }}</td>\r\n                  <td class=\"px-6 py-4 whitespace-nowrap\">\r\n                    {{ item.quantity_in_stock === 0 ? 'Out of Stock' : item.quantity_in_stock }}\r\n                  </td>\r\n                  <td class=\"px-6 py-4 whitespace-nowrap\">{{ item.min_stock_level }}</td>\r\n                  <td class=\"px-6 py-4 whitespace-nowrap\">P{{ parseFloat(item.unit_price).toFixed(2) }}</td>\r\n                  <td class=\"px-6 py-4 whitespace-nowrap\">{{ item.reorder_level }}</td>\r\n                  <td class=\"px-6 py-4 whitespace-nowrap\">\r\n                    <button @click=\"editItem(item)\" class=\"text-blue-600 hover:text-blue-900\">\r\n                      <EditIcon class=\"w-5 h-5\" />\r\n                    </button>\r\n                    <button @click=\"openReduceStockModal(item)\" class=\"text-red-600 hover:text-red-900\">\r\n                      <MinusIcon class=\"w-10 h-5\" />\r\n                    </button>\r\n                  </td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Pagination -->\r\n        <div class=\"mt-6 flex justify-between items-center\">\r\n          <div class=\"text-sm text-gray-700\">\r\n            Showing {{ paginationStart }} to {{ paginationEnd }} of {{ totalItems }} entries\r\n          </div>\r\n          <div class=\"flex space-x-2\">\r\n            <button \r\n              @click=\"prevPage\" \r\n              :disabled=\"currentPage === 1\" \r\n              class=\"btn-secondary px-3 py-1 disabled:opacity-50\"\r\n            >\r\n              <ChevronLeftIcon class=\"w-5 h-5\" />\r\n            </button>\r\n            <button \r\n              v-for=\"page in displayedPages\" \r\n              :key=\"page\" \r\n              @click=\"goToPage(page)\" \r\n              :class=\"['btn-secondary px-3 py-1', currentPage === page ? 'bg-blue-600 text-white' : '']\"\r\n            >\r\n              {{ page }}\r\n            </button>\r\n            <button \r\n              @click=\"nextPage\" \r\n              :disabled=\"currentPage === totalPages\" \r\n              class=\"btn-secondary px-3 py-1 disabled:opacity-50\"\r\n            >\r\n              <ChevronRightIcon class=\"w-5 h-5\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Add/Edit Item Modal -->\r\n      <div v-if=\"showAddModal\" class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4\">\r\n        <div class=\"bg-white rounded-lg shadow-xl w-full max-w-md\">\r\n          <div class=\"p-6\">\r\n            <h2 class=\"text-2xl font-bold mb-4\">{{ editingItem ? 'Edit' : 'Add New' }} Item</h2>\r\n            <form @submit.prevent=\"submitItem\">\r\n              <div class=\"space-y-4\">\r\n                <div>\r\n                  <label for=\"name\" class=\"block text-sm font-medium text-gray-700\">Name</label>\r\n                  <input type=\"text\" id=\"name\" v-model=\"currentItem.name\" required class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50\">\r\n                </div>\r\n                <div>\r\n                  <label for=\"description\" class=\"block text-sm font-medium text-gray-700\">Description</label>\r\n                  <textarea id=\"description\" v-model=\"currentItem.description\" rows=\"3\" class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50\"></textarea>\r\n                </div>\r\n                <div>\r\n                  <label for=\"category\" class=\"block text-sm font-medium text-gray-700\">Category</label>\r\n                  <select id=\"category\" v-model=\"currentItem.category_id\" required class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50\">\r\n                    <option v-for=\"category in categories\" :key=\"category.id\" :value=\"category.id\">{{ category.name }}</option>\r\n                  </select>\r\n                </div>\r\n\r\n                <div>\r\n                  <label for=\"minStockLevel\" class=\"block text-sm font-medium text-gray-700\">Min Stock Level</label>\r\n                  <input type=\"number\" id=\"minStockLevel\" v-model=\"currentItem.min_stock_level\" required min=\"0\" class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50\">\r\n                </div>\r\n                <div>\r\n                  <label for=\"reorderLevel\" class=\"block text-sm font-medium text-gray-700\">Reorder Level</label>\r\n                  <input type=\"number\" id=\"reorderLevel\" v-model=\"currentItem.reorder_level\" required min=\"0\" class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50\">\r\n                </div>\r\n              </div>\r\n              <div class=\"mt-6 flex justify-end space-x-3\">\r\n                <button type=\"button\" @click=\"closeModal\" class=\"btn-secondary\">Cancel</button>\r\n                <button type=\"submit\" class=\"btn-primary\">{{ editingItem ? 'Update' : 'Add' }} Item</button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n          <div v-if=\"showReduceStockModal\" class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4\">\r\n      <div class=\"bg-white rounded-lg shadow-xl w-full max-w-md\">\r\n        <div class=\"p-6\">\r\n          <h2 class=\"text-2xl font-bold mb-4\">Reduce Stock</h2>\r\n          <form @submit.prevent=\"reduceStock\">\r\n            <div class=\"space-y-4\">\r\n              <div>\r\n                <label for=\"reduceQuantity\" class=\"block text-sm font-medium text-gray-700\">Quantity to Reduce</label>\r\n                <input\r\n                  type=\"number\"\r\n                  id=\"reduceQuantity\"\r\n                  v-model=\"reduceQuantity\"\r\n                  required\r\n                  min=\"1\"\r\n                  :max=\"currentItem.quantity_in_stock\"\r\n                  class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <label for=\"patientAttachment\" class=\"block text-sm font-medium text-gray-700\">Patient Attachment</label>\r\n                <input\r\n                  type=\"text\"\r\n                  id=\"patientAttachment\"\r\n                  v-model=\"patientAttachment\"\r\n                  required\r\n                  class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50\"\r\n                />\r\n              </div>\r\n            </div>\r\n            <div class=\"mt-6 flex justify-end space-x-3\">\r\n              <button type=\"button\" @click=\"closeReduceStockModal\" class=\"btn-secondary\">Cancel</button>\r\n              <button type=\"submit\" class=\"btn-primary\">Reduce Stock</button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n\r\n\r\n    </div>\r\n  </template>\r\n\r\n  <script setup>\r\n  \r\n  import { ref, computed, onMounted, watch } from 'vue'\r\n  import { MinusIcon, PlusIcon, UploadIcon, EditIcon, SearchIcon, ChevronLeftIcon, ChevronRightIcon } from 'lucide-vue-next'\r\n  import axios from 'axios'\r\n  import debounce from 'lodash/debounce'\r\n\r\n  const API_URL = 'http://localhost:5000/api/inventory' // Replace with your actual API URL\r\n\r\n  const items = ref([])\r\n  const categories = ref([])\r\n  const tableHeaders = ['Name', 'Description', 'Category', 'Quantity in Stock', 'Min Stock Level', 'Unit Price', 'Reorder Level']\r\n\r\n  const searchQuery = ref('')\r\n  const selectedCategory = ref('')\r\n  const showAddModal = ref(false)\r\n  const showNewCategoryModal = ref(false)\r\n  const newCategory = ref({\r\n    name: '',\r\n    description: ''\r\n  })\r\n  const currentItem = ref({\r\n    name: '',\r\n    description: '',\r\n    category_id: null,\r\n    quantity_in_stock: 0,\r\n    min_stock_level: 0,\r\n    unit_price: 0,\r\n    reorder_level: 0\r\n  })\r\n  const editingItem = ref(null)\r\n\r\n\r\n\r\n  // Pagination\r\n  const itemsPerPage = 10\r\n  const currentPage = ref(1)\r\n  const totalItems = ref(0) // Ensure this is initialized to 0\r\n  const totalPages = computed(() => Math.ceil(totalItems.value / itemsPerPage))\r\n\r\n  const paginationStart = computed(() => Math.max((currentPage.value - 1) * itemsPerPage + 1, 0))\r\n  const paginationEnd = computed(() => Math.min(currentPage.value * itemsPerPage, totalItems.value))\r\n\r\n  const displayedPages = computed(() => {\r\n    const range = 2\r\n    let start = Math.max(1, currentPage.value - range)\r\n    let end = Math.min(totalPages.value, currentPage.value + range)\r\n\r\n    if (end - start + 1 < range * 2 + 1) {\r\n      if (start === 1) {\r\n        end = Math.min(start + range * 2, totalPages.value)\r\n      } else {\r\n        start = Math.max(end - range * 2, 1)\r\n      }\r\n    }\r\n\r\n    return Array.from({ length: end - start + 1 }, (_, i) => start + i)\r\n  })\r\n\r\n  // Watch for category selection\r\n  watch(() => currentItem.value.category_id, (newValue) => {\r\n    if (newValue === 'new') {\r\n      showNewCategoryModal.value = true\r\n      currentItem.value.category_id = '' // Reset selection\r\n    }\r\n  })\r\n\r\n  // Add new method to handle category changes\r\nconst handleCategoryChange = (event) => {\r\n  const value = event.target.value\r\n  if (value === 'new') {\r\n    showNewCategoryModal.value = true\r\n    // Store the previous selection\r\n    selectedCategory.value = ''\r\n  } else {\r\n    fetchItems()\r\n  }\r\n}\r\n\r\n  // Add new methods for category management\r\n  const closeNewCategoryModal = () => {\r\n  showNewCategoryModal.value = false\r\n  newCategory.value = {\r\n    name: '',\r\n    description: ''\r\n  }\r\n}\r\n  // Update submitNewCategory to handle both contexts\r\nconst submitNewCategory = async () => {\r\n  try {\r\n    const response = await axios.post(`${API_URL}/categories`, newCategory.value)\r\n    if (response.data.success) {\r\n      const newCat = response.data.data\r\n      // Add the new category to the categories list\r\n      categories.value.push(newCat)\r\n      \r\n      // If adding from the item modal, select the new category\r\n      if (showAddModal.value) {\r\n        currentItem.value.category_id = newCat.id\r\n      }\r\n      \r\n      // Close the modal and reset form\r\n      closeNewCategoryModal()\r\n      // Fetch items to refresh the list\r\n      fetchItems()\r\n    }\r\n  } catch (error) {\r\n    console.error('Error creating category:', error)\r\n  }\r\n}\r\n  onMounted(() => {\r\n    fetchCategories()\r\n    fetchItems()\r\n  })\r\n\r\n  const fetchCategories = async () => {\r\n    try {\r\n      const response = await axios.get(`${API_URL}/categories`)\r\n      categories.value = response.data.data\r\n    } catch (error) {\r\n      console.error('Error fetching categories:', error)\r\n    }\r\n  }\r\n\r\n  const debouncedFetchItems = debounce(() => {\r\n    fetchItems()\r\n  }, 300)\r\n\r\n  watch(searchQuery, () => {\r\n    debouncedFetchItems()\r\n  })\r\n\r\n  watch(selectedCategory, () => {\r\n    fetchItems()\r\n  })\r\n\r\n  const fetchItems = async () => {\r\n    try {\r\n      const response = await axios.get(`${API_URL}/items`, {\r\n        params: {\r\n          page: currentPage.value,\r\n          limit: itemsPerPage,\r\n          search: searchQuery.value,\r\n          category: selectedCategory.value\r\n        }\r\n      })\r\n      if (response.data.success) {\r\n        items.value = response.data.data || [] // Default to empty array if no data\r\n        totalItems.value = response.data.total_count || 0 // Default to 0 if no total count\r\n        console.log(\"Reorder Level:\",items.value.reorder_level);\r\n        if (currentPage.value > totalPages.value) {\r\n          currentPage.value = 1\r\n        }\r\n      } else {\r\n        console.error('Failed to fetch items:', response.data.message)\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching items:', error)\r\n    }\r\n  }\r\n\r\n  const prevPage = () => {\r\n    if (currentPage.value > 1) {\r\n      currentPage.value--\r\n      fetchItems()\r\n    }\r\n  }\r\n\r\n  const nextPage = () => {\r\n    if (currentPage.value < totalPages.value) {\r\n      currentPage.value++\r\n      fetchItems()\r\n    }\r\n  }\r\n\r\n  const goToPage = (page) => {\r\n    currentPage.value = page\r\n    fetchItems()\r\n  }\r\n\r\n  const editItem = (item) => {\r\n    editingItem.value = item\r\n    currentItem.value = { ...item }\r\n    showAddModal.value = true\r\n  }\r\n\r\n  const closeModal = () => {\r\n    showAddModal.value = false\r\n    editingItem.value = null\r\n    currentItem.value = {\r\n      name: '',\r\n      description: '',\r\n      category_id: null,\r\n      quantity_in_stock: 0,\r\n      min_stock_level: 0,\r\n      unit_price: 0,\r\n      reorder_level: 0\r\n    }\r\n  }\r\n\r\n  const submitItem = async () => {\r\n    try {\r\n      const itemData = {\r\n        name: currentItem.value.name,\r\n        description: currentItem.value.description,\r\n        category_id: parseInt(currentItem.value.category_id),\r\n        quantity_in_stock: parseInt(currentItem.value.quantity_in_stock),\r\n        min_stock_level: parseInt(currentItem.value.min_stock_level),\r\n        unit_price: parseFloat(currentItem.value.unit_price),\r\n        reorder_level: parseInt(currentItem.value.reorder_level)\r\n      }\r\n\r\n\r\n      if (editingItem.value) {\r\n        await axios.put(`${API_URL}/items/${editingItem.value.id}`, itemData)\r\n      } else {\r\n        await axios.post(`${API_URL}/items`, itemData)\r\n      }\r\n      closeModal()\r\n      fetchItems()\r\n    } catch (error) {\r\n      console.error('Error submitting item:', error)\r\n    }\r\n  }\r\n\r\n  const uploadExcel = async (event) => {\r\n    const file = event.target.files[0]\r\n    if (!file) return\r\n\r\n    const formData = new FormData()\r\n    formData.append('file', file)\r\n\r\n    try {\r\n      await axios.post(`${API_URL}/upload-excel`, formData, {\r\n        headers: {\r\n          'Content-Type': 'multipart/form-data'\r\n        }\r\n      })\r\n      fetchItems()\r\n    } catch (error) {\r\n      console.error('Error uploading Excel file:', error)\r\n    }\r\n  }\r\n\r\n  const getCategoryName = (categoryId) => {\r\n    const category = categories.value.find(cat => cat.id === categoryId)\r\n    return category ? category.name : 'Unknown'\r\n  }\r\n\r\n  const filteredItems = computed(() => {\r\n    let filtered = items.value\r\n    if (searchQuery.value) {\r\n      const query = searchQuery.value.toLowerCase()\r\n      filtered = filtered.filter(item => \r\n        item.name.toLowerCase().includes(query) ||\r\n        item.description.toLowerCase().includes(query)\r\n      )\r\n    }\r\n    if (selectedCategory.value) {\r\n      filtered = filtered.filter(item => item.category_id === parseInt(selectedCategory.value))\r\n    }\r\n    return filtered\r\n  })\r\n\r\n\r\n  const showReduceStockModal = ref(false);\r\n  const reduceQuantity = ref(0);\r\n\r\n  const openReduceStockModal = (item) => {\r\n    currentItem.value = { ...item };\r\n    reduceQuantity.value = 0;\r\n    showReduceStockModal.value = true;\r\n  };\r\n\r\n  const closeReduceStockModal = () => {\r\n    showReduceStockModal.value = false;\r\n    currentItem.value = {\r\n      name: '',\r\n      description: '',\r\n      category_id: null,\r\n      quantity_in_stock: 0,\r\n      min_stock_level: 0,\r\n      unit_price: 0,\r\n      reorder_level: 0,\r\n    };\r\n  };\r\n\r\n  const reduceStock = async () => {\r\n    try {\r\n      const response = await axios.post(`${API_URL}/items/${currentItem.value.id}/reduce-stock`, {\r\n        quantity: parseInt(reduceQuantity.value),\r\n      });\r\n\r\n      if (response.data.success) {\r\n        alert('Stock reduced successfully!');\r\n        closeReduceStockModal();\r\n        fetchItems();\r\n      } else {\r\n        alert('Failed to reduce stock. Please try again.');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error reducing stock:', error);\r\n      alert('An error occurred while reducing stock.');\r\n    }\r\n  };\r\n\r\n  </script>\r\n\r\n  <style scoped>\r\n  .btn-primary {\r\n    @apply bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition duration-300 ease-in-out flex items-center justify-center;\r\n  }\r\n\r\n  .btn-secondary {\r\n    @apply bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded transition duration-300 ease-in-out flex items-center justify-center;\r\n  }\r\n  </style>\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}