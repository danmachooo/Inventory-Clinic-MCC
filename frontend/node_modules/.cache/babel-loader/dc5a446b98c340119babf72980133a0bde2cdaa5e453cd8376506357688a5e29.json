{"ast":null,"code":"import { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, vModelSelect as _vModelSelect, withDirectives as _withDirectives, vModelText as _vModelText, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"container mx-auto px-4 py-8\"\n};\nvar _hoisted_2 = {\n  \"class\": \"mb-6 flex flex-wrap items-center gap-4\"\n};\nvar _hoisted_3 = {\n  \"class\": \"flex items-center\"\n};\nvar _hoisted_4 = {\n  key: 0,\n  \"class\": \"flex items-center\"\n};\nvar _hoisted_5 = {\n  key: 1,\n  \"class\": \"flex items-center\"\n};\nvar _hoisted_6 = [\"value\"];\nvar _hoisted_7 = {\n  key: 0,\n  \"class\": \"text-center py-8\"\n};\nvar _hoisted_8 = {\n  key: 1,\n  \"class\": \"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6\",\n  role: \"alert\"\n};\nvar _hoisted_9 = {\n  key: 2,\n  id: \"printable-content\"\n};\nvar _hoisted_10 = {\n  \"class\": \"text-2xl font-semibold text-gray-800 mb-4\"\n};\nvar _hoisted_11 = {\n  \"class\": \"mb-8\"\n};\nvar _hoisted_12 = {\n  \"class\": \"overflow-x-auto\"\n};\nvar _hoisted_13 = {\n  \"class\": \"min-w-full bg-white border border-gray-300\"\n};\nvar _hoisted_14 = {\n  \"class\": \"py-2 px-4 border-b\"\n};\nvar _hoisted_15 = {\n  \"class\": \"py-2 px-4 border-b\"\n};\nvar _hoisted_16 = {\n  \"class\": \"py-2 px-4 border-b text-right\"\n};\nvar _hoisted_17 = {\n  \"class\": \"py-2 px-4 border-b text-right\"\n};\nvar _hoisted_18 = {\n  \"class\": \"py-2 px-4 border-b text-right\"\n};\nvar _hoisted_19 = {\n  \"class\": \"mb-8 bg-gray-100 p-6 rounded-lg\"\n};\nvar _hoisted_20 = [\"innerHTML\"];\nvar _hoisted_21 = {\n  \"class\": \"mt-6 flex justify-center space-x-4 print:hidden\"\n};\nvar _hoisted_22 = [\"disabled\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[12] || (_cache[12] = _createElementVNode(\"h1\", {\n    \"class\": \"text-3xl font-bold text-gray-800 mb-6\"\n  }, \"Inventory Reports\", -1 /* HOISTED */)), _createCommentVNode(\" Report Type and Date Selection \"), _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_cache[4] || (_cache[4] = _createElementVNode(\"label\", {\n    \"for\": \"reportType\",\n    \"class\": \"mr-2 text-gray-700\"\n  }, \"Report Type:\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"select\", {\n    id: \"reportType\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n      return $setup.reportType = $event;\n    }),\n    onChange: $setup.fetchReport,\n    \"class\": \"border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n  }, _cache[3] || (_cache[3] = [_createElementVNode(\"option\", {\n    value: \"monthly\"\n  }, \"Monthly\", -1 /* HOISTED */), _createElementVNode(\"option\", {\n    value: \"yearly\"\n  }, \"Yearly\", -1 /* HOISTED */)]), 544 /* NEED_HYDRATION, NEED_PATCH */), [[_vModelSelect, $setup.reportType]])]), $setup.reportType === 'monthly' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_cache[5] || (_cache[5] = _createElementVNode(\"label\", {\n    \"for\": \"monthYear\",\n    \"class\": \"mr-2 text-gray-700\"\n  }, \"Select Month:\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    id: \"monthYear\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = function ($event) {\n      return $setup.selectedMonth = $event;\n    }),\n    type: \"month\",\n    onChange: $setup.fetchReport,\n    \"class\": \"border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n  }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [[_vModelText, $setup.selectedMonth]])])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_cache[6] || (_cache[6] = _createElementVNode(\"label\", {\n    \"for\": \"year\",\n    \"class\": \"mr-2 text-gray-700\"\n  }, \"Select Year:\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"select\", {\n    id: \"year\",\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = function ($event) {\n      return $setup.selectedYear = $event;\n    }),\n    onChange: $setup.fetchReport,\n    \"class\": \"border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n  }, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.availableYears, function (year) {\n    return _openBlock(), _createElementBlock(\"option\", {\n      key: year,\n      value: year\n    }, _toDisplayString(year), 9 /* TEXT, PROPS */, _hoisted_6);\n  }), 128 /* KEYED_FRAGMENT */))], 544 /* NEED_HYDRATION, NEED_PATCH */), [[_vModelSelect, $setup.selectedYear]])]))]), _createCommentVNode(\" Loading State \"), $setup.isLoading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, _cache[7] || (_cache[7] = [_createElementVNode(\"div\", {\n    \"class\": \"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto\"\n  }, null, -1 /* HOISTED */), _createElementVNode(\"p\", {\n    \"class\": \"mt-4 text-gray-600\"\n  }, \"Loading report data...\", -1 /* HOISTED */)]))) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Error Message \"), $setup.error ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [_cache[8] || (_cache[8] = _createElementVNode(\"p\", {\n    \"class\": \"font-bold\"\n  }, \"Error\", -1 /* HOISTED */)), _createElementVNode(\"p\", null, _toDisplayString($setup.error), 1 /* TEXT */)])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Report Content \"), !$setup.isLoading && !$setup.error ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [_createElementVNode(\"h2\", _hoisted_10, \" Inventory Report for \" + _toDisplayString($setup.reportTitle), 1 /* TEXT */), _createCommentVNode(\" Inventory Items Table \"), _createElementVNode(\"div\", _hoisted_11, [_cache[10] || (_cache[10] = _createElementVNode(\"h3\", {\n    \"class\": \"text-xl font-semibold text-gray-700 mb-3\"\n  }, \"Inventory Items\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_12, [_createElementVNode(\"table\", _hoisted_13, [_cache[9] || (_cache[9] = _createElementVNode(\"thead\", null, [_createElementVNode(\"tr\", {\n    \"class\": \"bg-gray-100\"\n  }, [_createElementVNode(\"th\", {\n    \"class\": \"py-2 px-4 border-b text-left\"\n  }, \"Item Name\"), _createElementVNode(\"th\", {\n    \"class\": \"py-2 px-4 border-b text-left\"\n  }, \"Batch Name\"), _createElementVNode(\"th\", {\n    \"class\": \"py-2 px-4 border-b text-right\"\n  }, \"Batch Quantity\"), _createElementVNode(\"th\", {\n    \"class\": \"py-2 px-4 border-b text-right\"\n  }, \"Total Disbursed\"), _createElementVNode(\"th\", {\n    \"class\": \"py-2 px-4 border-b text-right\"\n  }, \"Total Remaining\")])], -1 /* HOISTED */)), _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.reportData, function (item, index) {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: index,\n      \"class\": \"hover:bg-gray-50\"\n    }, [_createElementVNode(\"td\", _hoisted_14, _toDisplayString(item.itemName), 1 /* TEXT */), _createElementVNode(\"td\", _hoisted_15, _toDisplayString(item.batchName), 1 /* TEXT */), _createElementVNode(\"td\", _hoisted_16, _toDisplayString(item.batchQuantity), 1 /* TEXT */), _createElementVNode(\"td\", _hoisted_17, _toDisplayString(item.totalDisbursed), 1 /* TEXT */), _createElementVNode(\"td\", _hoisted_18, _toDisplayString(item.totalRemaining), 1 /* TEXT */)]);\n  }), 128 /* KEYED_FRAGMENT */))])])])]), _createCommentVNode(\" Narrative Report \"), _createElementVNode(\"div\", _hoisted_19, [_cache[11] || (_cache[11] = _createElementVNode(\"h3\", {\n    \"class\": \"text-xl font-semibold text-gray-700 mb-3\"\n  }, \"Executive Summary\", -1 /* HOISTED */)), _createElementVNode(\"div\", {\n    \"class\": \"text-gray-700 prose\",\n    innerHTML: $setup.narrativeReport\n  }, null, 8 /* PROPS */, _hoisted_20)]), _createCommentVNode(\" Action Buttons \"), _createElementVNode(\"div\", _hoisted_21, [_createElementVNode(\"button\", {\n    onClick: $setup.generateAndPrintPDF,\n    \"class\": \"bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline\",\n    disabled: $setup.isGeneratingPDF\n  }, _toDisplayString($setup.isGeneratingPDF ? 'Generating PDF...' : 'Generate and Print Report'), 9 /* TEXT, PROPS */, _hoisted_22)])])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["key","role","id","_createElementBlock","_hoisted_1","_createElementVNode","_createCommentVNode","_hoisted_2","_hoisted_3","_cache","$event","$setup","reportType","onChange","fetchReport","value","_hoisted_4","selectedMonth","type","_hoisted_5","selectedYear","_Fragment","_renderList","availableYears","year","_hoisted_6","isLoading","_hoisted_7","error","_hoisted_8","_toDisplayString","_hoisted_9","_hoisted_10","reportTitle","_hoisted_11","_hoisted_12","_hoisted_13","reportData","item","index","_hoisted_14","itemName","_hoisted_15","batchName","_hoisted_16","batchQuantity","_hoisted_17","totalDisbursed","_hoisted_18","totalRemaining","_hoisted_19","innerHTML","narrativeReport","_hoisted_20","_hoisted_21","onClick","generateAndPrintPDF","disabled","isGeneratingPDF","_hoisted_22"],"sources":["C:\\Inventory-Clinic-MCC\\frontend\\src\\views\\Reports.vue"],"sourcesContent":["<template>\r\n  <div class=\"container mx-auto px-4 py-8\">\r\n    <h1 class=\"text-3xl font-bold text-gray-800 mb-6\">Inventory Reports</h1>\r\n\r\n    <!-- Report Type and Date Selection -->\r\n    <div class=\"mb-6 flex flex-wrap items-center gap-4\">\r\n      <div class=\"flex items-center\">\r\n        <label for=\"reportType\" class=\"mr-2 text-gray-700\">Report Type:</label>\r\n        <select\r\n          id=\"reportType\"\r\n          v-model=\"reportType\"\r\n          @change=\"fetchReport\"\r\n          class=\"border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n        >\r\n          <option value=\"monthly\">Monthly</option>\r\n          <option value=\"yearly\">Yearly</option>\r\n        </select>\r\n      </div>\r\n\r\n      <div v-if=\"reportType === 'monthly'\" class=\"flex items-center\">\r\n        <label for=\"monthYear\" class=\"mr-2 text-gray-700\">Select Month:</label>\r\n        <input\r\n          id=\"monthYear\"\r\n          v-model=\"selectedMonth\"\r\n          type=\"month\"\r\n          @change=\"fetchReport\"\r\n          class=\"border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n        />\r\n      </div>\r\n\r\n      <div v-else class=\"flex items-center\">\r\n        <label for=\"year\" class=\"mr-2 text-gray-700\">Select Year:</label>\r\n        <select\r\n          id=\"year\"\r\n          v-model=\"selectedYear\"\r\n          @change=\"fetchReport\"\r\n          class=\"border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n        >\r\n          <option v-for=\"year in availableYears\" :key=\"year\" :value=\"year\">\r\n            {{ year }}\r\n          </option>\r\n        </select>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Loading State -->\r\n    <div v-if=\"isLoading\" class=\"text-center py-8\">\r\n      <div class=\"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto\"></div>\r\n      <p class=\"mt-4 text-gray-600\">Loading report data...</p>\r\n    </div>\r\n\r\n    <!-- Error Message -->\r\n    <div v-if=\"error\" class=\"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6\" role=\"alert\">\r\n      <p class=\"font-bold\">Error</p>\r\n      <p>{{ error }}</p>\r\n    </div>\r\n\r\n    <!-- Report Content -->\r\n    <div v-if=\"!isLoading && !error\" id=\"printable-content\">\r\n      <h2 class=\"text-2xl font-semibold text-gray-800 mb-4\">\r\n        Inventory Report for {{ reportTitle }}\r\n      </h2>\r\n\r\n      <!-- Inventory Items Table -->\r\n      <div class=\"mb-8\">\r\n        <h3 class=\"text-xl font-semibold text-gray-700 mb-3\">Inventory Items</h3>\r\n        <div class=\"overflow-x-auto\">\r\n          <table class=\"min-w-full bg-white border border-gray-300\">\r\n            <thead>\r\n              <tr class=\"bg-gray-100\">\r\n                <th class=\"py-2 px-4 border-b text-left\">Item Name</th>\r\n                <th class=\"py-2 px-4 border-b text-left\">Batch Name</th>\r\n                <th class=\"py-2 px-4 border-b text-right\">Batch Quantity</th>\r\n                <th class=\"py-2 px-4 border-b text-right\">Total Disbursed</th>\r\n                <th class=\"py-2 px-4 border-b text-right\">Total Remaining</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <tr v-for=\"(item, index) in reportData\" :key=\"index\" class=\"hover:bg-gray-50\">\r\n                <td class=\"py-2 px-4 border-b\">{{ item.itemName }}</td>\r\n                <td class=\"py-2 px-4 border-b\">{{ item.batchName }}</td>\r\n                <td class=\"py-2 px-4 border-b text-right\">{{ item.batchQuantity }}</td>\r\n                <td class=\"py-2 px-4 border-b text-right\">{{ item.totalDisbursed }}</td>\r\n                <td class=\"py-2 px-4 border-b text-right\">{{ item.totalRemaining }}</td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Narrative Report -->\r\n      <div class=\"mb-8 bg-gray-100 p-6 rounded-lg\">\r\n        <h3 class=\"text-xl font-semibold text-gray-700 mb-3\">Executive Summary</h3>\r\n        <div class=\"text-gray-700 prose\" v-html=\"narrativeReport\"></div>\r\n      </div>\r\n\r\n      <!-- Action Buttons -->\r\n      <div class=\"mt-6 flex justify-center space-x-4 print:hidden\">\r\n        <button\r\n          @click=\"generateAndPrintPDF\"\r\n          class=\"bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline\"\r\n          :disabled=\"isGeneratingPDF\"\r\n        >\r\n          {{ isGeneratingPDF ? 'Generating PDF...' : 'Generate and Print Report' }}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted } from 'vue';\r\nimport axios from 'axios';\r\nimport { jsPDF } from 'jspdf';\r\nimport 'jspdf-autotable';\r\n\r\nconst API_URL = 'http://localhost:5000';\r\n\r\nconst reportType = ref('monthly');\r\nconst selectedMonth = ref(new Date().toISOString().slice(0, 7));\r\nconst selectedYear = ref(new Date().getFullYear());\r\nconst availableYears = ref(Array.from({ length: 5 }, (_, i) => new Date().getFullYear() - i));\r\n\r\nconst reportData = ref([]);\r\nconst narrativeReport = ref('');\r\nconst isLoading = ref(false);\r\nconst error = ref(null);\r\nconst isGeneratingPDF = ref(false);\r\n\r\nconst reportTitle = computed(() => {\r\n  if (reportType.value === 'monthly') {\r\n    return new Date(selectedMonth.value).toLocaleString('default', { month: 'long', year: 'numeric' });\r\n  } else {\r\n    return selectedYear.value.toString();\r\n  }\r\n});\r\n\r\nconst fetchReport = async () => {\r\n  isLoading.value = true;\r\n  error.value = null;\r\n\r\n  try {\r\n    const params = {\r\n      type: reportType.value,\r\n      year: reportType.value === 'yearly' ? selectedYear.value : selectedMonth.value.split('-')[0],\r\n      month: reportType.value === 'monthly' ? selectedMonth.value.split('-')[1] : undefined,\r\n    };\r\n\r\n    const response = await axios.get(`${API_URL}/api/inventory/report`, { params });\r\n    reportData.value = response.data.data;\r\n    narrativeReport.value = generateNarrativeReport(reportData.value);\r\n  } catch (err) {\r\n    console.error('Error fetching report:', err);\r\n    error.value = 'Failed to fetch report data. Please try again.';\r\n  } finally {\r\n    isLoading.value = false;\r\n  }\r\n};\r\n\r\nconst generateNarrativeReport = (data) => {\r\n  const totalItems = data.length;\r\n  const totalQuantity = data.reduce((sum, item) => sum + item.batchQuantity, 0);\r\n  const totalDisbursed = data.reduce((sum, item) => sum + item.totalDisbursed, 0);\r\n  const totalRemaining = data.reduce((sum, item) => sum + item.totalRemaining, 0);\r\n\r\n  const lowStockItems = data.filter(item => item.totalRemaining < item.batchQuantity * 0.2);\r\n  const expiredItems = data.filter(item => item.totalRemaining === 0);\r\n\r\n  let report = `\r\n    <p>This comprehensive inventory report provides a detailed analysis of our stock levels, disbursements, and overall inventory health for the period of ${reportTitle.value}. The report aims to offer insights into our current inventory status, highlight potential areas of concern, and provide actionable recommendations for inventory management.</p>\r\n\r\n    <h4 class=\"font-semibold mt-4 mb-2\">Inventory Overview</h4>\r\n    <p>Our inventory currently comprises ${totalItems} distinct items, with a total initial quantity of ${totalQuantity} units. Throughout this reporting period, we have disbursed ${totalDisbursed} units, leaving a current stock level of ${totalRemaining} units. This represents a utilization rate of ${((totalDisbursed / totalQuantity) * 100).toFixed(2)}% of our initial inventory.</p>\r\n\r\n    <h4 class=\"font-semibold mt-4 mb-2\">Stock Level Analysis</h4>\r\n    <p>Upon careful examination of our current stock levels, we have identified the following key points of interest:</p>\r\n  `;\r\n\r\n  if (lowStockItems.length > 0) {\r\n    const percentLowStock = ((lowStockItems.length / totalItems) * 100).toFixed(2);\r\n    report += `\r\n      <p>Low Stock Alert: ${lowStockItems.length} item(s), representing ${percentLowStock}% of our inventory, are currently running low on stock (less than 20% remaining). These items require immediate attention and potential restocking:</p>\r\n      <ul class=\"list-disc list-inside mb-2\">\r\n        ${lowStockItems.map(item => `<li>${item.itemName} (Remaining: ${item.totalRemaining} units)</li>`).join('')}\r\n      </ul>\r\n      <p>It is recommended to initiate the reordering process for these items to prevent potential stockouts and ensure uninterrupted operations.</p>\r\n    `;\r\n  } else {\r\n    report += `\r\n      <p>Stock Levels: All items in our inventory are currently maintaining adequate stock levels, with no items falling below the 20% threshold. This indicates effective inventory management and timely restocking practices.</p>\r\n    `;\r\n  }\r\n\r\n  if (expiredItems.length > 0) {\r\n    const percentExpired = ((expiredItems.length / totalItems) * 100).toFixed(2);\r\n    report += `\r\n      <h4 class=\"font-semibold mt-4 mb-2\">Expired or Depleted Items</h4>\r\n      <p>${expiredItems.length} item(s), accounting for ${percentExpired}% of our inventory, have been fully depleted or have expired:</p>\r\n      <ul class=\"list-disc list-inside mb-2\">\r\n        ${expiredItems.map(item => `<li>${item.itemName}</li>`).join('')}\r\n      </ul>\r\n      <p>It is crucial to review these items promptly. For expired items, proper disposal procedures should be followed, and for depleted items, assess the demand and consider replenishing if necessary.</p>\r\n    `;\r\n  }\r\n\r\n  report += `\r\n    <h4 class=\"font-semibold mt-4 mb-2\">Recommendations</h4>\r\n    <ol class=\"list-decimal list-inside\">\r\n      <li>Implement a more proactive approach to inventory management, particularly for items identified as low in stock.</li>\r\n      <li>Conduct a thorough review of the demand patterns for depleted items to optimize future stock levels.</li>\r\n      <li>Consider setting up automated alerts for items approaching low stock thresholds to facilitate timely reordering.</li>\r\n      <li>Regularly assess and adjust minimum stock levels based on current demand and lead times.</li>\r\n    </ol>\r\n\r\n    <p class=\"mt-4\">By addressing these points, we can enhance our inventory management efficiency, reduce the risk of stockouts, and optimize our working capital allocation.</p>\r\n  `;\r\n\r\n  return report;\r\n};\r\n\r\nconst generateAndPrintPDF = async () => {\r\n  isGeneratingPDF.value = true;\r\n\r\n  try {\r\n    const doc = new jsPDF({\r\n      format: 'legal',\r\n      orientation: 'portrait',\r\n      unit: 'mm',\r\n    });\r\n\r\n    // Title\r\n    doc.setFontSize(18);\r\n    doc.text(`Inventory Report for ${reportTitle.value}`, 14, 20);\r\n\r\n    // Inventory Items Table\r\n    doc.autoTable({\r\n      startY: 30,\r\n      head: [['Item Name', 'Batch Name', 'Batch Quantity', 'Total Disbursed', 'Total Remaining']],\r\n      body: reportData.value.map(item => [\r\n        item.itemName,\r\n        item.batchName,\r\n        item.batchQuantity,\r\n        item.totalDisbursed,\r\n        item.totalRemaining,\r\n      ]),\r\n    });\r\n\r\n    // Narrative Report\r\n    doc.setFontSize(14);\r\n    doc.text('Executive Summary', 14, doc.lastAutoTable.finalY + 10);\r\n    doc.setFontSize(12);\r\n    const splitNarrativeReport = doc.splitTextToSize(narrativeReport.value.replace(/<[^>]+>/g, ''), 180);\r\n    doc.text(splitNarrativeReport, 14, doc.lastAutoTable.finalY + 20);\r\n\r\n    // Instead of saving the PDF, open it in a new window and print\r\n    const pdfData = doc.output('datauristring');\r\n    const pdfWindow = window.open();\r\n    pdfWindow.document.write(`<iframe width='100%' height='100%' src='${pdfData}'></iframe>`);\r\n    pdfWindow.document.close();\r\n    pdfWindow.focus();\r\n\r\n    // Wait for the PDF to load before printing\r\n    pdfWindow.onload = () => {\r\n      pdfWindow.print();\r\n      isGeneratingPDF.value = false;\r\n    };\r\n  } catch (err) {\r\n    console.error('Error generating PDF:', err);\r\n    error.value = 'Failed to generate PDF. Please try again.';\r\n    isGeneratingPDF.value = false;\r\n  }\r\n};\r\n\r\n\r\nonMounted(fetchReport);\r\n</script>\r\n\r\n<style>\r\n@media print {\r\n  body * {\r\n    visibility: hidden;\r\n  }\r\n  #printable-content, #printable-content * {\r\n    visibility: visible;\r\n  }\r\n  #printable-content {\r\n    position: absolute;\r\n    left: 0;\r\n    top: 0;\r\n  }\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}