{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/Lenovo Pc/OneDrive - Department of Education/Desktop/MCDL-MINSU-CLINIC/Inventory-Clinic-MCC/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _slicedToArray from \"C:/Users/Lenovo Pc/OneDrive - Department of Education/Desktop/MCDL-MINSU-CLINIC/Inventory-Clinic-MCC/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _asyncToGenerator from \"C:/Users/Lenovo Pc/OneDrive - Department of Education/Desktop/MCDL-MINSU-CLINIC/Inventory-Clinic-MCC/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.date.to-string.js\";\nimport \"core-js/modules/es.object.define-property.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/web.timers.js\";\nimport { ref, onMounted, onUnmounted } from 'vue';\nimport axios from 'axios';\nimport DashboardCard from '../components/DashboardCard.vue';\nvar API_URL = 'http://localhost:5000/api/inventory';\nexport default {\n  __name: 'Dashboard',\n  setup: function setup(__props, _ref) {\n    var __expose = _ref.expose;\n    __expose();\n    var totalItems = ref(0);\n    var lowStockCount = ref(0);\n    var expiringCount = ref(0);\n    var recentTransactions = ref([]);\n    var notifications = ref([]);\n    var pollingInterval = ref(5000);\n    var pollingTimer = null;\n    var fetchDashboardData = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var _yield$Promise$all, _yield$Promise$all2, itemsResponse, lowStockResponse, expiringResponse, transactionsResponse, notificationsResponse;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return Promise.all([axios.get(\"\".concat(API_URL, \"/items\")), axios.get(\"\".concat(API_URL, \"/low-stock\")), axios.get(\"\".concat(API_URL, \"/expiring-batches\")), axios.get(\"\".concat(API_URL, \"/transactions\")), axios.get(\"\".concat(API_URL, \"/notifications\"))]);\n            case 3:\n              _yield$Promise$all = _context.sent;\n              _yield$Promise$all2 = _slicedToArray(_yield$Promise$all, 5);\n              itemsResponse = _yield$Promise$all2[0];\n              lowStockResponse = _yield$Promise$all2[1];\n              expiringResponse = _yield$Promise$all2[2];\n              transactionsResponse = _yield$Promise$all2[3];\n              notificationsResponse = _yield$Promise$all2[4];\n              totalItems.value = itemsResponse.data.data.length;\n              lowStockCount.value = lowStockResponse.data.data.length;\n              expiringCount.value = expiringResponse.data.data.length;\n              recentTransactions.value = transactionsResponse.data.data.slice(0, 5);\n              notifications.value = notificationsResponse.data.data.slice(0, 5);\n              _context.next = 20;\n              break;\n            case 17:\n              _context.prev = 17;\n              _context.t0 = _context[\"catch\"](0);\n              console.error('Error fetching dashboard data:', _context.t0);\n            case 20:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[0, 17]]);\n      }));\n      return function fetchDashboardData() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    var startPolling = function startPolling() {\n      fetchDashboardData();\n      pollingTimer = setInterval(fetchDashboardData, pollingInterval.value);\n    };\n    var stopPolling = function stopPolling() {\n      if (pollingTimer) {\n        clearInterval(pollingTimer);\n      }\n    };\n    var formatDate = function formatDate(dateString) {\n      return new Date(dateString).toLocaleDateString('en-US', {\n        year: 'numeric',\n        month: 'short',\n        day: 'numeric'\n      });\n    };\n    var getNotificationClass = function getNotificationClass(type) {\n      var classes = {\n        'LOW_STOCK': 'bg-yellow-100',\n        'EXPIRED': 'bg-red-100',\n        'SOON_EXPIRING': 'bg-blue-100',\n        'REORDER': 'bg-green-100'\n      };\n      return classes[type] || 'bg-gray-100';\n    };\n    var getNotificationTitle = function getNotificationTitle(notification) {\n      var titles = {\n        'LOW_STOCK': 'Low Stock Alert',\n        'EXPIRED': 'Batch Expired',\n        'SOON_EXPIRING': 'Batch Expiring Soon',\n        'REORDER': 'Reorder Required'\n      };\n      return titles[notification.notification_type] || 'Notification';\n    };\n    var getTransactionTypeClass = function getTransactionTypeClass(type) {\n      var classes = {\n        'IN': 'text-green-600 bg-green-100 px-2 py-1 rounded-full',\n        'OUT': 'text-red-600 bg-red-100 px-2 py-1 rounded-full',\n        'ADJUSTMENT': 'text-blue-600 bg-blue-100 px-2 py-1 rounded-full'\n      };\n      return classes[type] || 'text-gray-600 bg-gray-100 px-2 py-1 rounded-full';\n    };\n    onMounted(function () {\n      startPolling();\n    });\n    onUnmounted(function () {\n      stopPolling();\n    });\n    var __returned__ = {\n      totalItems: totalItems,\n      lowStockCount: lowStockCount,\n      expiringCount: expiringCount,\n      recentTransactions: recentTransactions,\n      notifications: notifications,\n      API_URL: API_URL,\n      pollingInterval: pollingInterval,\n      get pollingTimer() {\n        return pollingTimer;\n      },\n      set pollingTimer(v) {\n        pollingTimer = v;\n      },\n      fetchDashboardData: fetchDashboardData,\n      startPolling: startPolling,\n      stopPolling: stopPolling,\n      formatDate: formatDate,\n      getNotificationClass: getNotificationClass,\n      getNotificationTitle: getNotificationTitle,\n      getTransactionTypeClass: getTransactionTypeClass,\n      ref: ref,\n      onMounted: onMounted,\n      onUnmounted: onUnmounted,\n      get axios() {\n        return axios;\n      },\n      DashboardCard: DashboardCard\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","onUnmounted","axios","DashboardCard","API_URL","totalItems","lowStockCount","expiringCount","recentTransactions","notifications","pollingInterval","pollingTimer","fetchDashboardData","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$Promise$all","_yield$Promise$all2","itemsResponse","lowStockResponse","expiringResponse","transactionsResponse","notificationsResponse","wrap","_callee$","_context","prev","next","Promise","all","get","concat","sent","_slicedToArray","value","data","length","slice","t0","console","error","stop","apply","arguments","startPolling","setInterval","stopPolling","clearInterval","formatDate","dateString","Date","toLocaleDateString","year","month","day","getNotificationClass","type","classes","getNotificationTitle","notification","titles","notification_type","getTransactionTypeClass"],"sources":["C:/Users/Lenovo Pc/OneDrive - Department of Education/Desktop/MCDL-MINSU-CLINIC/Inventory-Clinic-MCC/frontend/src/views/Dashboard.vue"],"sourcesContent":["<template>\r\n  <div class=\"bg-gray-100 min-h-screen\">\r\n    <div class=\"container mx-auto px-4 py-8\">\r\n      <h1 class=\"text-3xl font-bold text-gray-800 mb-8\">Dashboard</h1>\r\n      \r\n      <div class=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\r\n        <DashboardCard title=\"Total Items\" :value=\"totalItems\" icon=\"Package\" color=\"bg-blue-500\" />\r\n        <DashboardCard title=\"Low Stock Alerts\" :value=\"lowStockCount\" icon=\"AlertTriangle\" color=\"bg-yellow-500\" />\r\n        <DashboardCard title=\"Expiring Soon\" :value=\"expiringCount\" icon=\"Clock\" color=\"bg-red-500\" />\r\n      </div>\r\n\r\n      <div class=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\r\n        <!-- Recent Transactions -->\r\n        <div class=\"bg-white shadow-lg rounded-lg overflow-hidden\">\r\n          <div class=\"px-6 py-4 bg-gray-50 border-b border-gray-200\">\r\n            <h2 class=\"text-xl font-semibold text-gray-800\">Recent Transactions</h2>\r\n          </div>\r\n          <div class=\"p-6\">\r\n            <div class=\"overflow-x-auto\">\r\n              <table class=\"w-full\">\r\n                <thead>\r\n                  <tr class=\"text-left text-xs font-semibold text-gray-600 uppercase tracking-wider\">\r\n                    <th class=\"pb-3 pr-6\">Item</th>\r\n                    <th class=\"pb-3 pr-6\">Action</th>\r\n                    <th class=\"pb-3 pr-6\">Quantity</th>\r\n                    <th class=\"pb-3\">Date</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody class=\"divide-y divide-gray-200\">\r\n                  <tr v-for=\"transaction in recentTransactions\" :key=\"transaction.id\" class=\"text-sm\">\r\n                    <td class=\"py-4 pr-6 whitespace-nowrap\">{{ transaction.InventoryItem.name }}</td>\r\n                    <td class=\"py-4 pr-6 whitespace-nowrap\">\r\n                      <span :class=\"getTransactionTypeClass(transaction.transaction_type)\">\r\n                        {{ transaction.transaction_type }}\r\n                      </span>\r\n                    </td>\r\n                    <td class=\"py-4 pr-6 whitespace-nowrap\">{{ transaction.quantity_change }}</td>\r\n                    <td class=\"py-4 whitespace-nowrap\">{{ formatDate(transaction.date) }}</td>\r\n                  </tr>\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Notifications -->\r\n        <div class=\"bg-white shadow-lg rounded-lg overflow-hidden\">\r\n          <div class=\"px-6 py-4 bg-gray-50 border-b border-gray-200\">\r\n            <h2 class=\"text-xl font-semibold text-gray-800\">Notifications</h2>\r\n          </div>\r\n          <div class=\"p-6\">\r\n            <div class=\"space-y-4\">\r\n              <div v-for=\"notification in notifications\" :key=\"notification.id\" \r\n                   class=\"p-4 rounded-lg\"\r\n                   :class=\"getNotificationClass(notification.notification_type)\">\r\n                <h3 class=\"font-semibold text-gray-800\">\r\n                  {{ getNotificationTitle(notification) }}\r\n                </h3>\r\n                <p class=\"text-gray-600 mt-1\">\r\n                  {{ notification.message }}\r\n                </p>\r\n                <p class=\"text-xs text-gray-500 mt-2\">\r\n                  {{ formatDate(notification.created_at) }}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, onUnmounted } from 'vue'\r\nimport axios from 'axios'\r\nimport DashboardCard from '../components/DashboardCard.vue'\r\n\r\nconst totalItems = ref(0)\r\nconst lowStockCount = ref(0)\r\nconst expiringCount = ref(0)\r\nconst recentTransactions = ref([])\r\nconst notifications = ref([])\r\nconst API_URL = 'http://localhost:5000/api/inventory'\r\nconst pollingInterval = ref(5000) \r\nlet pollingTimer = null\r\n\r\nconst fetchDashboardData = async () => {\r\n  try {\r\n    const [itemsResponse, lowStockResponse, expiringResponse, transactionsResponse, notificationsResponse] = await Promise.all([\r\n      axios.get(`${API_URL}/items`),\r\n      axios.get(`${API_URL}/low-stock`),\r\n      axios.get(`${API_URL}/expiring-batches`),\r\n      axios.get(`${API_URL}/transactions`),\r\n      axios.get(`${API_URL}/notifications`)\r\n    ])\r\n\r\n    totalItems.value = itemsResponse.data.data.length\r\n    lowStockCount.value = lowStockResponse.data.data.length\r\n    expiringCount.value = expiringResponse.data.data.length\r\n    recentTransactions.value = transactionsResponse.data.data.slice(0, 5)\r\n    notifications.value = notificationsResponse.data.data.slice(0, 5)\r\n  } catch (error) {\r\n    console.error('Error fetching dashboard data:', error)\r\n  }\r\n}\r\n\r\nconst startPolling = () => {\r\n  fetchDashboardData()\r\n  pollingTimer = setInterval(fetchDashboardData, pollingInterval.value)\r\n}\r\n\r\nconst stopPolling = () => {\r\n  if (pollingTimer) {\r\n    clearInterval(pollingTimer)\r\n  }\r\n}\r\n\r\nconst formatDate = (dateString) => {\r\n  return new Date(dateString).toLocaleDateString('en-US', {\r\n    year: 'numeric',\r\n    month: 'short',\r\n    day: 'numeric'\r\n  })\r\n}\r\n\r\nconst getNotificationClass = (type) => {\r\n  const classes = {\r\n    'LOW_STOCK': 'bg-yellow-100',\r\n    'EXPIRED': 'bg-red-100',\r\n    'SOON_EXPIRING': 'bg-blue-100',\r\n    'REORDER': 'bg-green-100'\r\n  }\r\n  return classes[type] || 'bg-gray-100'\r\n}\r\n\r\nconst getNotificationTitle = (notification) => {\r\n  const titles = {\r\n    'LOW_STOCK': 'Low Stock Alert',\r\n    'EXPIRED': 'Batch Expired',\r\n    'SOON_EXPIRING': 'Batch Expiring Soon',\r\n    'REORDER': 'Reorder Required'\r\n  }\r\n  return titles[notification.notification_type] || 'Notification'\r\n}\r\n\r\nconst getTransactionTypeClass = (type) => {\r\n  const classes = {\r\n    'IN': 'text-green-600 bg-green-100 px-2 py-1 rounded-full',\r\n    'OUT': 'text-red-600 bg-red-100 px-2 py-1 rounded-full',\r\n    'ADJUSTMENT': 'text-blue-600 bg-blue-100 px-2 py-1 rounded-full'\r\n  }\r\n  return classes[type] || 'text-gray-600 bg-gray-100 px-2 py-1 rounded-full'\r\n}\r\n\r\nonMounted(() => {\r\n  startPolling()\r\n})\r\n\r\nonUnmounted(() => {\r\n  stopPolling()\r\n})\r\n</script>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}